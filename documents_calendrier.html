<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calendrier scolaire</title>
    <style>
        body { 
            margin: 0; padding: 0; background-color: #000; 
            overflow: hidden; /* Bloque le scroll de la page */
            touch-action: none; /* Bloque le Pull-to-Refresh de l'app */
            font-family: sans-serif;
        }
        
        .back-btn {
            position: fixed; top: 20px; left: 20px;
            background: #71bd7b; color: #052e16;
            padding: 12px 20px; border-radius: 50px;
            text-decoration: none; font-weight: 800;
            z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        #viewport {
            width: 100vw; height: 100vh;
            display: flex; cursor: grab;
        }
    </style>
</head>
<body>

    <a href="documents.html" class="back-btn">← Retour</a>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        img.src = 'documents_calendrier.jpg'; // <--- Nom de votre image

        let scale = 1;
        let viewX = 0;
        let viewY = 0;

        img.onload = () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            // Centre l'image au départ
            scale = Math.min(canvas.width / img.width, canvas.height / img.height);
            viewX = (canvas.width - img.width * scale) / 2;
            viewY = (canvas.height - img.height * scale) / 2;
            draw();
        };

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(img, viewX, viewY, img.width * scale, img.height * scale);
        }

        // --- GESTION TACTILE AVANCÉE (ANTI-SACCADE) ---
        let lastDist = 0;
        let lastX = 0;
        let lastY = 0;

        canvas.addEventListener('touchstart', e => {
            if (e.touches.length === 1) {
                lastX = e.touches[0].clientX;
                lastY = e.touches[0].clientY;
            } else if (e.touches.length === 2) {
                lastDist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY);
            }
        }, { passive: false });

        canvas.addEventListener('touchmove', e => {
            e.preventDefault(); // BLOQUE l'actualisation de l'App (Pull-to-refresh)

            if (e.touches.length === 1) {
                // Déplacement (Pan)
                const dx = e.touches[0].clientX - lastX;
                const dy = e.touches[0].clientY - lastY;
                viewX += dx; viewY += dy;
                lastX = e.touches[0].clientX;
                lastY = e.touches[0].clientY;
            } else if (e.touches.length === 2) {
                // Zoom (Pinch)
                const dist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY);
                const zoom = dist / lastDist;
                
                // Zoomer vers le centre des doigts
                const centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2;
                const centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2;
                
                viewX = centerX - (centerX - viewX) * zoom;
                viewY = centerY - (centerY - viewY) * zoom;
                scale *= zoom;
                lastDist = dist;
            }
            draw();
        }, { passive: false });

    </script>
</body>
</html>
