<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Comptes de la classe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: black; 
            color: white;
            -webkit-tap-highlight-color: transparent;
        }
        .custom-card { 
            border-radius: 30% 0% 30% 0%; 
            border-width: 2px;
        }
        input, select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 8px;
            padding: 8px;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-start min-h-screen p-4">

    <div class="w-full max-w-[320px]">
        <header class="flex items-center justify-between mb-6">
            <a href="index.html" class="text-white text-2xl">←</a>
            <h1 class="text-white text-xl font-bold tracking-tight">Comptes Classe</h1>
            <div class="w-8"></div>
        </header>

        <div id="balance-card" class="custom-card bg-emerald-200 border-emerald-900 p-6 mb-6 text-center">
            <h2 class="text-emerald-900 text-xs font-bold uppercase tracking-widest mb-1">Solde Actuel</h2>
            <div id="total-balance" class="text-3xl font-bold text-black">0,00 €</div>
        </div>

        <div class="space-y-3 mb-8 bg-gray-900/50 p-4 rounded-2xl border border-gray-800">
            <input type="text" id="label" placeholder="Libellé (ex: Coopérative)" class="w-full">
            <div class="flex gap-2">
                <input type="number" id="amount" placeholder="Montant" class="w-full">
                <select id="type" class="bg-gray-800">
                    <option value="plus">+</option>
                    <option value="minus">-</option>
                </select>
            </div>
            <button onclick="addTransaction()" class="w-full py-3 bg-emerald-500 text-black font-bold rounded-xl active:scale-95 transition-transform">
                Ajouter l'opération
            </button>
        </div>

        <div id="transaction-list" class="space-y-2">
            </div>
    </div>

    <script>
        let transactions = JSON.parse(localStorage.getItem('class_accounts')) || [];

        function render() {
            const list = document.getElementById('transaction-list');
            const totalEl = document.getElementById('total-balance');
            const balanceCard = document.getElementById('balance-card');
            list.innerHTML = '';
            
            let total = 0;

            transactions.forEach((t, index) => {
                const isPlus = t.type === 'plus';
                total += isPlus ? parseFloat(t.amount) : -parseFloat(t.amount);

                const item = document.createElement('div');
                item.className = `flex justify-between items-center p-3 rounded-lg border ${isPlus ? 'border-emerald-900/50 bg-emerald-900/20' : 'border-rose-900/50 bg-rose-900/20'}`;
                item.innerHTML = `
                    <div>
                        <div class="text-sm font-medium">${t.label}</div>
                        <div class="text-[10px] opacity-50">${t.date}</div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="font-bold ${isPlus ? 'text-emerald-400' : 'text-rose-400'}">
                            ${isPlus ? '+' : '-'}${t.amount}€
                        </span>
                        <button onclick="deleteTx(${index})" class="text-xs opacity-30">✕</button>
                    </div>
                `;
                list.appendChild(item);
            });

            totalEl.innerText = total.toFixed(2) + " €";
            
            // Changement de couleur du badge de solde si négatif
            if (total < 0) {
                balanceCard.className = "custom-card bg-rose-200 border-rose-900 p-6 mb-6 text-center";
                totalEl.classList.replace('text-emerald-900', 'text-rose-900');
            } else {
                balanceCard.className = "custom-card bg-emerald-200 border-emerald-900 p-6 mb-6 text-center";
            }
        }

        function addTransaction() {
            const label = document.getElementById('label').value;
            const amount = document.getElementById('amount').value;
            const type = document.getElementById('type').value;
            const date = new Date().toLocaleDateString('fr-FR');

            if (!label || !amount) return;

            transactions.unshift({ label, amount, type, date });
            localStorage.setItem('class_accounts', JSON.stringify(transactions));
            
            document.getElementById('label').value = '';
            document.getElementById('amount').value = '';
            render();
        }

        function deleteTx(index) {
            transactions.splice(index, 1);
            localStorage.setItem('class_accounts', JSON.stringify(transactions));
            render();
        }

        render();
    </script>
</body>
</html>